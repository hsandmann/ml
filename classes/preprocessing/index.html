<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Sandmann, H."><link href=https://hsandmann.github.io/ml/classes/preprocessing/ rel=canonical><link href=../decision_tree/ rel=prev><link href=../knn/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>3. Preprocessing - Machine Learning</title><link rel=stylesheet href=../../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20352a32%2032%200%201%200%200%2064%2032%2032%200%201%200%200-64m0-192c-18.2%200-32.7%2015.5-31.4%2033.7l7.4%20104c.9%2012.5%2011.4%2022.3%2023.9%2022.3%2012.6%200%2023-9.7%2023.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../assets/stylesheets/neoteroi-mkdocs.min.css><link rel=stylesheet href=../../assets/stylesheets/neoteroi-timeline.css><link rel=stylesheet href=../../assets/stylesheets/extra.css><link rel=stylesheet href=../../assets/stylesheets/badge.css><link rel=stylesheet href=../../termynal.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#typical-preprocessing-tasks class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Machine Learning" class="md-header__button md-logo" aria-label="Machine Learning" data-md-component=logo> <img src=../../assets/images/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Machine Learning </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 3. Preprocessing </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hsandmann/ml title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> hsandmann/ml </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Machine Learning" class="md-nav__button md-logo" aria-label="Machine Learning" data-md-component=logo> <img src=../../assets/images/logo.png alt=logo> </a> Machine Learning </label> <div class=md-nav__source> <a href=https://github.com/hsandmann/ml title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> hsandmann/ml </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../versions/2025.2/ class=md-nav__link> <span class=md-ellipsis> 2025.2 </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Classes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Classes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> 1. Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> 1. Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../concepts/ml/ class=md-nav__link> <span class=md-ellipsis> 1.1. Machine Learning </span> </a> </li> <li class=md-nav__item> <a href=../concepts/kdd/ class=md-nav__link> <span class=md-ellipsis> 1.2. KDD </span> </a> </li> <li class=md-nav__item> <a href=../concepts/data/ class=md-nav__link> <span class=md-ellipsis> 1.3. Data </span> </a> </li> <li class=md-nav__item> <a href=../concepts/exercise/ class=md-nav__link> <span class=md-ellipsis> 1.4. Exercise </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../decision_tree/ class=md-nav__link> <span class=md-ellipsis> 2. Decision Tree </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 3. Preprocessing </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 3. Preprocessing </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#typical-preprocessing-tasks class=md-nav__link> <span class=md-ellipsis> Typical Preprocessing Tasks </span> </a> </li> <li class=md-nav__item> <a href=#data-cleaning class=md-nav__link> <span class=md-ellipsis> Data Cleaning </span> </a> </li> <li class=md-nav__item> <a href=#encoding-categorical-variables class=md-nav__link> <span class=md-ellipsis> Encoding Categorical Variables </span> </a> </li> <li class=md-nav__item> <a href=#normalization-and-standardization class=md-nav__link> <span class=md-ellipsis> Normalization and Standardization </span> </a> </li> <li class=md-nav__item> <a href=#feature-scaling class=md-nav__link> <span class=md-ellipsis> Feature Scaling </span> </a> </li> <li class=md-nav__item> <a href=#data-augmentation class=md-nav__link> <span class=md-ellipsis> Data Augmentation </span> </a> </li> <li class=md-nav__item> <a href=#handling-imbalanced-data class=md-nav__link> <span class=md-ellipsis> Handling Imbalanced Data </span> </a> </li> <li class=md-nav__item> <a href=#feature-engineering-and-selection class=md-nav__link> <span class=md-ellipsis> Feature Engineering and Selection </span> </a> </li> <li class=md-nav__item> <a href=#dimensionality-reduction class=md-nav__link> <span class=md-ellipsis> Dimensionality Reduction </span> </a> </li> <li class=md-nav__item> <a href=#domain-specific-advanced-techniques class=md-nav__link> <span class=md-ellipsis> Domain-Specific Advanced Techniques </span> </a> </li> <li class=md-nav__item> <a href=#appendix class=md-nav__link> <span class=md-ellipsis> Appendix </span> </a> <nav class=md-nav aria-label=Appendix> <ul class=md-nav__list> <li class=md-nav__item> <a href=#normalization-vs-standardization-in-neural-network-preprocessing class=md-nav__link> <span class=md-ellipsis> Normalization vs. Standardization in Neural Network Preprocessing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../knn/ class=md-nav__link> <span class=md-ellipsis> 4. KNN </span> </a> </li> <li class=md-nav__item> <a href=../kmeans/ class=md-nav__link> <span class=md-ellipsis> 5. K-Means </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6 id=__nav_2_6_label tabindex=0> <span class=md-ellipsis> 6. Metrics and Evaluation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> 6. Metrics and Evaluation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../metrics/classification/ class=md-nav__link> <span class=md-ellipsis> 6.1. Classification </span> </a> </li> <li class=md-nav__item> <a href=../metrics/regression/ class=md-nav__link> <span class=md-ellipsis> 6.2. Regression </span> </a> </li> <li class=md-nav__item> <a href=../metrics/exercise/ class=md-nav__link> <span class=md-ellipsis> 6.3. Exercise </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../random_forest/ class=md-nav__link> <span class=md-ellipsis> 7. Random Forest </span> </a> </li> <li class=md-nav__item> <a href=../naive_bayes/ class=md-nav__link> <span class=md-ellipsis> 8. Naïve Bayes </span> </a> </li> <li class=md-nav__item> <a href=../gradient_boosting/index.md class=md-nav__link> <span class=md-ellipsis> 9. Gradient boosting </span> </a> </li> <li class=md-nav__item> <a href=../svm/ class=md-nav__link> <span class=md-ellipsis> 10. SVM </span> </a> </li> <li class=md-nav__item> <a href=../page-rank/ class=md-nav__link> <span class=md-ellipsis> 11. Page Rank </span> </a> </li> <li class=md-nav__item> <a href=../pyspark/ class=md-nav__link> <span class=md-ellipsis> 12. PySpark </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_13> <label class=md-nav__link for=__nav_2_13 id=__nav_2_13_label tabindex=0> <span class=md-ellipsis> 13. Neural Networks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_13_label aria-expanded=false> <label class=md-nav__title for=__nav_2_13> <span class="md-nav__icon md-icon"></span> 13. Neural Networks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../neural_network/perceptron/index.md class=md-nav__link> <span class=md-ellipsis> 13.1. Perceptron </span> </a> </li> <li class=md-nav__item> <a href=../neural_network/mlp/index.md class=md-nav__link> <span class=md-ellipsis> 13.2. MLP </span> </a> </li> <li class=md-nav__item> <a href=../neural_network/exercise/index.md class=md-nav__link> <span class=md-ellipsis> 13.5. Exercise </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Projects </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../versions/2025.2/projects/1/ class=md-nav__link> <span class=md-ellipsis> Project I </span> </a> </li> <li class=md-nav__item> <a href=../../versions/2025.2/projects/2/ class=md-nav__link> <span class=md-ellipsis> Project II </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Versions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Versions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../versions/2025.2/ class=md-nav__link> <span class=md-ellipsis> 2025.2 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#typical-preprocessing-tasks class=md-nav__link> <span class=md-ellipsis> Typical Preprocessing Tasks </span> </a> </li> <li class=md-nav__item> <a href=#data-cleaning class=md-nav__link> <span class=md-ellipsis> Data Cleaning </span> </a> </li> <li class=md-nav__item> <a href=#encoding-categorical-variables class=md-nav__link> <span class=md-ellipsis> Encoding Categorical Variables </span> </a> </li> <li class=md-nav__item> <a href=#normalization-and-standardization class=md-nav__link> <span class=md-ellipsis> Normalization and Standardization </span> </a> </li> <li class=md-nav__item> <a href=#feature-scaling class=md-nav__link> <span class=md-ellipsis> Feature Scaling </span> </a> </li> <li class=md-nav__item> <a href=#data-augmentation class=md-nav__link> <span class=md-ellipsis> Data Augmentation </span> </a> </li> <li class=md-nav__item> <a href=#handling-imbalanced-data class=md-nav__link> <span class=md-ellipsis> Handling Imbalanced Data </span> </a> </li> <li class=md-nav__item> <a href=#feature-engineering-and-selection class=md-nav__link> <span class=md-ellipsis> Feature Engineering and Selection </span> </a> </li> <li class=md-nav__item> <a href=#dimensionality-reduction class=md-nav__link> <span class=md-ellipsis> Dimensionality Reduction </span> </a> </li> <li class=md-nav__item> <a href=#domain-specific-advanced-techniques class=md-nav__link> <span class=md-ellipsis> Domain-Specific Advanced Techniques </span> </a> </li> <li class=md-nav__item> <a href=#appendix class=md-nav__link> <span class=md-ellipsis> Appendix </span> </a> <nav class=md-nav aria-label=Appendix> <ul class=md-nav__list> <li class=md-nav__item> <a href=#normalization-vs-standardization-in-neural-network-preprocessing class=md-nav__link> <span class=md-ellipsis> Normalization vs. Standardization in Neural Network Preprocessing </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>3. Preprocessing</h1> <p>Data preprocessing is a critical phase in the development of neural network models, ensuring that raw data is transformed into a suitable format for effective training and inference. This text explores both basic and advanced preprocessing techniques, drawing from established methodologies in machine learning and deep learning. Basic techniques focus on cleaning and normalizing data to handle inconsistencies and scale issues, while advanced methods address complex challenges such as data scarcity, imbalance, and high dimensionality. The discussion highlights their relevance to neural networks, including convolutional neural networks (CNNs), recurrent neural networks (RNNs), and transformers, with emphasis on improving model convergence, generalization, and performance.</p> <p>Neural networks, as powerful function approximators, are <strong>highly sensitive to the quality and format of input data</strong>. Poorly prepared data can lead to slow convergence, overfitting, or suboptimal accuracy. Preprocessing mitigates these issues by addressing noise, inconsistencies, and structural mismatches in datasets. It encompasses a series of steps that transform raw data into a form that aligns with the assumptions and requirements of neural architectures. For instance, in supervised learning tasks, preprocessing ensures features are scaled appropriately to prevent gradient issues during backpropagation. This text delineates basic techniques, which are foundational and widely applicable, and advanced techniques, which are more specialized and often domain-specific, such as for image, text, or time-series data.</p> <h2 id=typical-preprocessing-tasks>Typical Preprocessing Tasks</h2> <table> <thead> <tr> <th>Task</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><strong>Text Cleaning</strong></td> <td>Remove unwanted characters, stop words, and perform stemming/lemmatization.</td> </tr> <tr> <td><strong>Normalization</strong></td> <td>Standardize text formats, such as date and currency formats.</td> </tr> <tr> <td><strong>Tokenization</strong></td> <td>Split text into words or subwords for easier analysis.</td> </tr> <tr> <td><strong>Feature Extraction</strong></td> <td>Convert text into numerical features using techniques like TF-IDF or word embeddings.</td> </tr> <tr> <td><strong>Data Augmentation</strong></td> <td>Generate synthetic data to increase dataset size and diversity.</td> </tr> </tbody> </table> <p>A typical dataset for machine learning tasks might include columns of different data types, such as numerical, categorical, and text, eg.:</p> <figure> <table> <thead> <tr> <th style="text-align: right;">PassengerId</th> <th style="text-align: right;">Survived</th> <th style="text-align: right;">Pclass</th> <th style="text-align: left;">Name</th> <th style="text-align: left;">Sex</th> <th style="text-align: right;">Age</th> <th style="text-align: right;">SibSp</th> <th style="text-align: right;">Parch</th> <th style="text-align: left;">Ticket</th> <th style="text-align: right;">Fare</th> <th style="text-align: left;">Cabin</th> <th style="text-align: left;">Embarked</th> </tr> </thead> <tbody> <tr> <td style="text-align: right;">91</td> <td style="text-align: right;">0</td> <td style="text-align: right;">3</td> <td style="text-align: left;">Christmann, Mr. Emil</td> <td style="text-align: left;">male</td> <td style="text-align: right;">29</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: left;">343276</td> <td style="text-align: right;">8.05</td> <td style="text-align: left;">nan</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">665</td> <td style="text-align: right;">1</td> <td style="text-align: right;">3</td> <td style="text-align: left;">Lindqvist, Mr. Eino William</td> <td style="text-align: left;">male</td> <td style="text-align: right;">20</td> <td style="text-align: right;">1</td> <td style="text-align: right;">0</td> <td style="text-align: left;">STON/O 2. 3101285</td> <td style="text-align: right;">7.925</td> <td style="text-align: left;">nan</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">879</td> <td style="text-align: right;">0</td> <td style="text-align: right;">3</td> <td style="text-align: left;">Laleff, Mr. Kristo</td> <td style="text-align: left;">male</td> <td style="text-align: right;">nan</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: left;">349217</td> <td style="text-align: right;">7.8958</td> <td style="text-align: left;">nan</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">331</td> <td style="text-align: right;">1</td> <td style="text-align: right;">3</td> <td style="text-align: left;">McCoy, Miss. Agnes</td> <td style="text-align: left;">female</td> <td style="text-align: right;">nan</td> <td style="text-align: right;">2</td> <td style="text-align: right;">0</td> <td style="text-align: left;">367226</td> <td style="text-align: right;">23.25</td> <td style="text-align: left;">nan</td> <td style="text-align: left;">Q</td> </tr> <tr> <td style="text-align: right;">445</td> <td style="text-align: right;">1</td> <td style="text-align: right;">3</td> <td style="text-align: left;">Johannesen-Bratthammer, Mr. Bernt</td> <td style="text-align: left;">male</td> <td style="text-align: right;">nan</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: left;">65306</td> <td style="text-align: right;">8.1125</td> <td style="text-align: left;">nan</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">166</td> <td style="text-align: right;">1</td> <td style="text-align: right;">3</td> <td style="text-align: left;">Goldsmith, Master. Frank John William "Frankie"</td> <td style="text-align: left;">male</td> <td style="text-align: right;">9</td> <td style="text-align: right;">0</td> <td style="text-align: right;">2</td> <td style="text-align: left;">363291</td> <td style="text-align: right;">20.525</td> <td style="text-align: left;">nan</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">464</td> <td style="text-align: right;">0</td> <td style="text-align: right;">2</td> <td style="text-align: left;">Milling, Mr. Jacob Christian</td> <td style="text-align: left;">male</td> <td style="text-align: right;">48</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: left;">234360</td> <td style="text-align: right;">13</td> <td style="text-align: left;">nan</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">194</td> <td style="text-align: right;">1</td> <td style="text-align: right;">2</td> <td style="text-align: left;">Navratil, Master. Michel M</td> <td style="text-align: left;">male</td> <td style="text-align: right;">3</td> <td style="text-align: right;">1</td> <td style="text-align: right;">1</td> <td style="text-align: left;">230080</td> <td style="text-align: right;">26</td> <td style="text-align: left;">F2</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">882</td> <td style="text-align: right;">0</td> <td style="text-align: right;">3</td> <td style="text-align: left;">Markun, Mr. Johann</td> <td style="text-align: left;">male</td> <td style="text-align: right;">33</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: left;">349257</td> <td style="text-align: right;">7.8958</td> <td style="text-align: left;">nan</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">625</td> <td style="text-align: right;">0</td> <td style="text-align: right;">3</td> <td style="text-align: left;">Bowen, Mr. David John "Dai"</td> <td style="text-align: left;">male</td> <td style="text-align: right;">21</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: left;">54636</td> <td style="text-align: right;">16.1</td> <td style="text-align: left;">nan</td> <td style="text-align: left;">S</td> </tr> </tbody> </table> <figcaption> <p>Sample rows from the Titanic dataset</p> </figcaption> </figure> <h2 id=data-cleaning>Data Cleaning</h2> <p>Data cleaning involves identifying and rectifying errors, inconsistencies, and missing values in the dataset. Missing values, common in real-world data, can be handled by imputation methods such as mean, median, or mode substitution, or by removing affected rows/columns if the loss is minimal. For example, in pandas, this can be implemented as <code>df.fillna(df.mean())</code> for mean imputation. Outliers, which may skew neural network training, are detected using statistical methods like z-scores or interquartile ranges and can be winsorized or removed. Noise reduction, such as smoothing time-series data with moving averages, is also essential, particularly for RNNs where temporal dependencies are critical. Inconsistent data, like varying formats in text (e.g., dates), requires standardization to ensure uniformity. Overall, data cleaning enhances data quality, reducing the risk of misleading patterns during neural network optimization.</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Result</label><label for=__tabbed_1_2>Code</label></div> <div class=tabbed-content> <div class=tabbed-block> <table> <thead> <tr> <th style="text-align: right;">Pclass</th> <th style="text-align: left;">Sex</th> <th style="text-align: right;">Age</th> <th style="text-align: right;">SibSp</th> <th style="text-align: right;">Parch</th> <th style="text-align: right;">Fare</th> <th style="text-align: left;">Embarked</th> </tr> </thead> <tbody> <tr> <td style="text-align: right;">3</td> <td style="text-align: left;">male</td> <td style="text-align: right;">38.5</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">8.05</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">2</td> <td style="text-align: left;">male</td> <td style="text-align: right;">42</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">13</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">3</td> <td style="text-align: left;">female</td> <td style="text-align: right;">47</td> <td style="text-align: right;">1</td> <td style="text-align: right;">0</td> <td style="text-align: right;">14.5</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">2</td> <td style="text-align: left;">female</td> <td style="text-align: right;">38</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">13</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">3</td> <td style="text-align: left;">female</td> <td style="text-align: right;">30</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">12.475</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">1</td> <td style="text-align: left;">male</td> <td style="text-align: right;">31</td> <td style="text-align: right;">1</td> <td style="text-align: right;">0</td> <td style="text-align: right;">52</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">3</td> <td style="text-align: left;">female</td> <td style="text-align: right;">18</td> <td style="text-align: right;">2</td> <td style="text-align: right;">0</td> <td style="text-align: right;">18</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">1</td> <td style="text-align: left;">female</td> <td style="text-align: right;">40</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">153.463</td> <td style="text-align: left;">S</td> </tr> <tr> <td style="text-align: right;">2</td> <td style="text-align: left;">male</td> <td style="text-align: right;">38.5</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">13.8625</td> <td style="text-align: left;">C</td> </tr> <tr> <td style="text-align: right;">3</td> <td style="text-align: left;">female</td> <td style="text-align: right;">39</td> <td style="text-align: right;">1</td> <td style="text-align: right;">5</td> <td style="text-align: right;">31.275</td> <td style="text-align: left;">S</td> </tr> </tbody> </table> </div> <div class=tabbed-block> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=c1># Preprocess the data</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=k>def</span><span class=w> </span><span class=nf>preprocess</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>    <span class=c1># Fill missing values</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>    <span class=n>df</span><span class=p>[</span><span class=s1>'Age'</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Age'</span><span class=p>]</span><span class=o>.</span><span class=n>median</span><span class=p>(),</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>    <span class=n>df</span><span class=p>[</span><span class=s1>'Embarked'</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Embarked'</span><span class=p>]</span><span class=o>.</span><span class=n>mode</span><span class=p>()[</span><span class=mi>0</span><span class=p>],</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>    <span class=n>df</span><span class=p>[</span><span class=s1>'Fare'</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Fare'</span><span class=p>]</span><span class=o>.</span><span class=n>median</span><span class=p>(),</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>    <span class=c1># Select features</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>    <span class=n>features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'Pclass'</span><span class=p>,</span> <span class=s1>'Sex'</span><span class=p>,</span> <span class=s1>'Age'</span><span class=p>,</span> <span class=s1>'SibSp'</span><span class=p>,</span> <span class=s1>'Parch'</span><span class=p>,</span> <span class=s1>'Fare'</span><span class=p>,</span> <span class=s1>'Embarked'</span><span class=p>]</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>    <span class=k>return</span> <span class=n>df</span><span class=p>[</span><span class=n>features</span><span class=p>]</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=c1># Load the Titanic dataset</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'https://raw.githubusercontent.com/hsandmann/ml/refs/heads/main/data/kaggle/titanic-dataset.csv'</span><span class=p>)</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=c1># Preprocessing</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=n>df</span> <span class=o>=</span> <span class=n>preprocess</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=c1># Display the first few rows of the dataset</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>to_markdown</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
</span></code></pre></div> </div> </div> </div> <h2 id=encoding-categorical-variables>Encoding Categorical Variables</h2> <p>Categorical data, non-numeric by nature, must be converted for neural network input. One-hot encoding creates binary vectors for each category, e.g., transforming colors <code>['red', 'blue', 'green']</code> into <code>[[1,0,0], [0,1,0], [0,0,1]]</code>. This avoids ordinal assumptions but increases dimensionality, which can be mitigated by embedding layers in neural networks for high-cardinality features. Label encoding assigns integers (e.g., 0 for "red", 1 for "blue"), suitable for ordinal categories but risky for nominal ones due to implied ordering. For text data in NLP tasks with transformers, tokenization and subword encoding (e.g., WordPiece) are basic steps to map words to integer IDs.</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Result</label><label for=__tabbed_2_2>Code</label></div> <div class=tabbed-content> <div class=tabbed-block> <table> <thead> <tr> <th style="text-align: right;">Pclass</th> <th style="text-align: right;">Sex</th> <th style="text-align: right;">Age</th> <th style="text-align: right;">SibSp</th> <th style="text-align: right;">Parch</th> <th style="text-align: right;">Fare</th> <th style="text-align: right;">Embarked</th> </tr> </thead> <tbody> <tr> <td style="text-align: right;">3</td> <td style="text-align: right;">0</td> <td style="text-align: right;">21</td> <td style="text-align: right;">2</td> <td style="text-align: right;">2</td> <td style="text-align: right;">34.375</td> <td style="text-align: right;">2</td> </tr> <tr> <td style="text-align: right;">2</td> <td style="text-align: right;">0</td> <td style="text-align: right;">30</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">12.35</td> <td style="text-align: right;">1</td> </tr> <tr> <td style="text-align: right;">2</td> <td style="text-align: right;">0</td> <td style="text-align: right;">25</td> <td style="text-align: right;">0</td> <td style="text-align: right;">1</td> <td style="text-align: right;">26</td> <td style="text-align: right;">2</td> </tr> <tr> <td style="text-align: right;">1</td> <td style="text-align: right;">0</td> <td style="text-align: right;">2</td> <td style="text-align: right;">1</td> <td style="text-align: right;">2</td> <td style="text-align: right;">151.55</td> <td style="text-align: right;">2</td> </tr> <tr> <td style="text-align: right;">1</td> <td style="text-align: right;">1</td> <td style="text-align: right;">65</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">26.55</td> <td style="text-align: right;">2</td> </tr> <tr> <td style="text-align: right;">3</td> <td style="text-align: right;">0</td> <td style="text-align: right;">18</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">7.4958</td> <td style="text-align: right;">2</td> </tr> <tr> <td style="text-align: right;">2</td> <td style="text-align: right;">1</td> <td style="text-align: right;">3</td> <td style="text-align: right;">1</td> <td style="text-align: right;">1</td> <td style="text-align: right;">18.75</td> <td style="text-align: right;">2</td> </tr> </tbody> </table> </div> <div class=tabbed-block> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>LabelEncoder</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=c1># Preprocess the data</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=k>def</span><span class=w> </span><span class=nf>preprocess</span><span class=p>(</span><span class=n>df</span><span class=p>):</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>    <span class=c1># Fill missing values</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>    <span class=n>df</span><span class=p>[</span><span class=s1>'Age'</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Age'</span><span class=p>]</span><span class=o>.</span><span class=n>median</span><span class=p>(),</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>    <span class=n>df</span><span class=p>[</span><span class=s1>'Embarked'</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Embarked'</span><span class=p>]</span><span class=o>.</span><span class=n>mode</span><span class=p>()[</span><span class=mi>0</span><span class=p>],</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=n>df</span><span class=p>[</span><span class=s1>'Fare'</span><span class=p>]</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Fare'</span><span class=p>]</span><span class=o>.</span><span class=n>median</span><span class=p>(),</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>    <span class=c1># Convert categorical variables</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>    <span class=n>label_encoder</span> <span class=o>=</span> <span class=n>LabelEncoder</span><span class=p>()</span>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>    <span class=n>df</span><span class=p>[</span><span class=s1>'Sex'</span><span class=p>]</span> <span class=o>=</span> <span class=n>label_encoder</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Sex'</span><span class=p>])</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>    <span class=n>df</span><span class=p>[</span><span class=s1>'Embarked'</span><span class=p>]</span> <span class=o>=</span> <span class=n>label_encoder</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Embarked'</span><span class=p>])</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>    <span class=c1># Select features</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>    <span class=n>features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>'Pclass'</span><span class=p>,</span> <span class=s1>'Sex'</span><span class=p>,</span> <span class=s1>'Age'</span><span class=p>,</span> <span class=s1>'SibSp'</span><span class=p>,</span> <span class=s1>'Parch'</span><span class=p>,</span> <span class=s1>'Fare'</span><span class=p>,</span> <span class=s1>'Embarked'</span><span class=p>]</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>    <span class=k>return</span> <span class=n>df</span><span class=p>[</span><span class=n>features</span><span class=p>]</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=c1># Load the Titanic dataset</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>'https://raw.githubusercontent.com/hsandmann/ml/refs/heads/main/data/kaggle/titanic-dataset.csv'</span><span class=p>)</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=c1># Preprocessing</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=n>df</span> <span class=o>=</span> <span class=n>preprocess</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=c1># Display the first few rows of the dataset</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>sample</span><span class=p>(</span><span class=n>n</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span><span class=o>.</span><span class=n>to_markdown</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
</span></code></pre></div> </div> </div> </div> <h2 id=normalization-and-standardization>Normalization and Standardization</h2> <p>Normalization scales features to a bounded range, typically <span class=arithmatex>\([0, 1]\)</span>, using min-max scaling:</p> <div class=arithmatex>\[ x' = \displaystyle \frac{x - \min(x)}{\max(x) - \min(x)} \]</div> <p>This is crucial for neural networks employing sigmoid or tanh activations, as it prevents saturation.</p> <p>Standardization, or z-score normalization, transforms data to have a mean of <span class=arithmatex>\(0\)</span> and standard deviation of <span class=arithmatex>\(1\)</span>:</p> <div class=arithmatex>\[ x' = \frac{x - \mu}{\sigma}, \]</div> <p>where <span class=arithmatex>\(\mu\)</span> is the mean and <span class=arithmatex>\(\sigma\)</span> the standard deviation. It is preferred for networks with ReLU activations or when data distributions are Gaussian-like, aiding faster gradient descent convergence. In practice, libraries like scikit-learn provide <code>MinMaxScaler</code> and <code>StandardScaler</code> for these operations. These techniques are especially vital in multilayer perceptrons (MLPs) and CNNs, where feature scales can dominate loss landscapes.</p> <p>Below is an example of how to apply normalization and standardization using pandas, based on the <a href=https://ranaroussi.github.io/yfinance/ target=_blank>NASDAQ Apple stock price dataset</a>:</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:3><input checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><input id=__tabbed_3_3 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Result</label><label for=__tabbed_3_2>Original</label><label for=__tabbed_3_3>Code</label></div> <div class=tabbed-content> <div class=tabbed-block> <table> <thead> <tr> <th style="text-align: left;">Date</th> <th style="text-align: right;">Volume</th> <th style="text-align: right;">N-Volume</th> <th style="text-align: right;">Z-Volume</th> <th style="text-align: right;">Change</th> <th style="text-align: right;">N-Change</th> <th style="text-align: right;">Z-Change</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">2025-09-23 00:00:00-04:00</td> <td style="text-align: right;">6.02752e+07</td> <td style="text-align: right;">0.384975</td> <td style="text-align: right;">0.657546</td> <td style="text-align: right;">-0.00644328</td> <td style="text-align: right;">0.379644</td> <td style="text-align: right;">-0.546397</td> </tr> <tr> <td style="text-align: left;">2025-09-24 00:00:00-04:00</td> <td style="text-align: right;">4.23037e+07</td> <td style="text-align: right;">0.14067</td> <td style="text-align: right;">-0.334271</td> <td style="text-align: right;">-0.00833233</td> <td style="text-align: right;">0.354103</td> <td style="text-align: right;">-0.677452</td> </tr> <tr> <td style="text-align: left;">2025-09-25 00:00:00-04:00</td> <td style="text-align: right;">5.52021e+07</td> <td style="text-align: right;">0.316011</td> <td style="text-align: right;">0.37757</td> <td style="text-align: right;">0.018073</td> <td style="text-align: right;">0.711121</td> <td style="text-align: right;">1.15445</td> </tr> <tr> <td style="text-align: left;">2025-09-26 00:00:00-04:00</td> <td style="text-align: right;">4.60763e+07</td> <td style="text-align: right;">0.191955</td> <td style="text-align: right;">-0.126068</td> <td style="text-align: right;">-0.00548911</td> <td style="text-align: right;">0.392545</td> <td style="text-align: right;">-0.480201</td> </tr> <tr> <td style="text-align: left;">2025-09-29 00:00:00-04:00</td> <td style="text-align: right;">4.01277e+07</td> <td style="text-align: right;">0.111089</td> <td style="text-align: right;">-0.454361</td> <td style="text-align: right;">-0.004032</td> <td style="text-align: right;">0.412246</td> <td style="text-align: right;">-0.379112</td> </tr> <tr> <td style="text-align: left;">2025-09-30 00:00:00-04:00</td> <td style="text-align: right;">3.77043e+07</td> <td style="text-align: right;">0.0781454</td> <td style="text-align: right;">-0.588105</td> <td style="text-align: right;">0.000786119</td> <td style="text-align: right;">0.477391</td> <td style="text-align: right;">-0.0448497</td> </tr> <tr> <td style="text-align: left;">2025-10-01 00:00:00-04:00</td> <td style="text-align: right;">4.87139e+07</td> <td style="text-align: right;">0.22781</td> <td style="text-align: right;">0.019497</td> <td style="text-align: right;">0.00322033</td> <td style="text-align: right;">0.510303</td> <td style="text-align: right;">0.124026</td> </tr> <tr> <td style="text-align: left;">2025-10-02 00:00:00-04:00</td> <td style="text-align: right;">4.26302e+07</td> <td style="text-align: right;">0.145108</td> <td style="text-align: right;">-0.316252</td> <td style="text-align: right;">0.00657666</td> <td style="text-align: right;">0.555683</td> <td style="text-align: right;">0.356875</td> </tr> <tr> <td style="text-align: left;">2025-10-03 00:00:00-04:00</td> <td style="text-align: right;">4.91556e+07</td> <td style="text-align: right;">0.233815</td> <td style="text-align: right;">0.0438737</td> <td style="text-align: right;">0.00346122</td> <td style="text-align: right;">0.51356</td> <td style="text-align: right;">0.140739</td> </tr> <tr> <td style="text-align: left;">2025-10-06 00:00:00-04:00</td> <td style="text-align: right;">4.46641e+07</td> <td style="text-align: right;">0.172757</td> <td style="text-align: right;">-0.204005</td> <td style="text-align: right;">-0.00515459</td> <td style="text-align: right;">0.397068</td> <td style="text-align: right;">-0.456993</td> </tr> </tbody> </table> </div> <div class=tabbed-block> <table> <thead> <tr> <th style="text-align: left;">Date</th> <th style="text-align: right;">Open</th> <th style="text-align: right;">High</th> <th style="text-align: right;">Low</th> <th style="text-align: right;">Close</th> <th style="text-align: right;">Volume</th> <th style="text-align: right;">Dividends</th> <th style="text-align: right;">Stock Splits</th> <th style="text-align: right;">Change</th> </tr> </thead> <tbody> <tr> <td style="text-align: left;">2025-09-22 00:00:00-04:00</td> <td style="text-align: right;">248.3</td> <td style="text-align: right;">256.64</td> <td style="text-align: right;">248.12</td> <td style="text-align: right;">256.08</td> <td style="text-align: right;">1.05517e+08</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">nan</td> </tr> <tr> <td style="text-align: left;">2025-09-23 00:00:00-04:00</td> <td style="text-align: right;">255.88</td> <td style="text-align: right;">257.34</td> <td style="text-align: right;">253.58</td> <td style="text-align: right;">254.43</td> <td style="text-align: right;">6.02752e+07</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">-0.00644328</td> </tr> <tr> <td style="text-align: left;">2025-09-24 00:00:00-04:00</td> <td style="text-align: right;">255.22</td> <td style="text-align: right;">255.74</td> <td style="text-align: right;">251.04</td> <td style="text-align: right;">252.31</td> <td style="text-align: right;">4.23037e+07</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">-0.00833233</td> </tr> <tr> <td style="text-align: left;">2025-09-25 00:00:00-04:00</td> <td style="text-align: right;">253.21</td> <td style="text-align: right;">257.17</td> <td style="text-align: right;">251.71</td> <td style="text-align: right;">256.87</td> <td style="text-align: right;">5.52021e+07</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0.018073</td> </tr> <tr> <td style="text-align: left;">2025-09-26 00:00:00-04:00</td> <td style="text-align: right;">254.1</td> <td style="text-align: right;">257.6</td> <td style="text-align: right;">253.78</td> <td style="text-align: right;">255.46</td> <td style="text-align: right;">4.60763e+07</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">-0.00548911</td> </tr> <tr> <td style="text-align: left;">2025-09-29 00:00:00-04:00</td> <td style="text-align: right;">254.56</td> <td style="text-align: right;">255</td> <td style="text-align: right;">253.01</td> <td style="text-align: right;">254.43</td> <td style="text-align: right;">4.01277e+07</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">-0.004032</td> </tr> <tr> <td style="text-align: left;">2025-09-30 00:00:00-04:00</td> <td style="text-align: right;">254.86</td> <td style="text-align: right;">255.92</td> <td style="text-align: right;">253.11</td> <td style="text-align: right;">254.63</td> <td style="text-align: right;">3.77043e+07</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0.000786119</td> </tr> <tr> <td style="text-align: left;">2025-10-01 00:00:00-04:00</td> <td style="text-align: right;">255.04</td> <td style="text-align: right;">258.79</td> <td style="text-align: right;">254.93</td> <td style="text-align: right;">255.45</td> <td style="text-align: right;">4.87139e+07</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0.00322033</td> </tr> <tr> <td style="text-align: left;">2025-10-02 00:00:00-04:00</td> <td style="text-align: right;">256.58</td> <td style="text-align: right;">258.18</td> <td style="text-align: right;">254.15</td> <td style="text-align: right;">257.13</td> <td style="text-align: right;">4.26302e+07</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0.00657666</td> </tr> <tr> <td style="text-align: left;">2025-10-03 00:00:00-04:00</td> <td style="text-align: right;">254.67</td> <td style="text-align: right;">259.24</td> <td style="text-align: right;">253.95</td> <td style="text-align: right;">258.02</td> <td style="text-align: right;">4.91556e+07</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0</td> <td style="text-align: right;">0.00346122</td> </tr> </tbody> </table> </div> <div class=tabbed-block> <div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=kn>import</span><span class=w> </span><span class=nn>yfinance</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>yf</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=n>dat</span> <span class=o>=</span> <span class=n>yf</span><span class=o>.</span><span class=n>Ticker</span><span class=p>(</span><span class=s2>"AAPL"</span><span class=p>)</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=n>df</span> <span class=o>=</span> <span class=n>dat</span><span class=o>.</span><span class=n>history</span><span class=p>(</span><span class=n>period</span><span class=o>=</span><span class=s1>'1mo'</span><span class=p>)</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=n>df</span><span class=p>[</span><span class=s1>'Change'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'Close'</span><span class=p>]</span><span class=o>.</span><span class=n>pct_change</span><span class=p>()</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>df</span><span class=p>[</span><span class=s1>'Z-Volume'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'Volume'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=n>x</span><span class=o>-</span><span class=n>df</span><span class=p>[</span><span class=s1>'Volume'</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span><span class=o>/</span><span class=n>df</span><span class=p>[</span><span class=s1>'Volume'</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>())</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=n>df</span><span class=p>[</span><span class=s1>'N-Volume'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'Volume'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=n>x</span><span class=o>-</span><span class=n>df</span><span class=p>[</span><span class=s1>'Volume'</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>())</span><span class=o>/</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Volume'</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>-</span><span class=n>df</span><span class=p>[</span><span class=s1>'Volume'</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()))</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=n>df</span><span class=p>[</span><span class=s1>'Z-Change'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'Change'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=n>x</span><span class=o>-</span><span class=n>df</span><span class=p>[</span><span class=s1>'Change'</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span><span class=o>/</span><span class=n>df</span><span class=p>[</span><span class=s1>'Change'</span><span class=p>]</span><span class=o>.</span><span class=n>std</span><span class=p>())</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=n>df</span><span class=p>[</span><span class=s1>'N-Change'</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>'Change'</span><span class=p>]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=p>(</span><span class=n>x</span><span class=o>-</span><span class=n>df</span><span class=p>[</span><span class=s1>'Change'</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>())</span><span class=o>/</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>'Change'</span><span class=p>]</span><span class=o>.</span><span class=n>max</span><span class=p>()</span><span class=o>-</span><span class=n>df</span><span class=p>[</span><span class=s1>'Change'</span><span class=p>]</span><span class=o>.</span><span class=n>min</span><span class=p>()))</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>'Volume'</span><span class=p>,</span> <span class=s1>'N-Volume'</span><span class=p>,</span> <span class=s1>'Z-Volume'</span><span class=p>,</span> <span class=s1>'Change'</span><span class=p>,</span> <span class=s1>'N-Change'</span><span class=p>,</span> <span class=s1>'Z-Change'</span><span class=p>]]</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=o>.</span><span class=n>to_markdown</span><span class=p>())</span>
</span></code></pre></div> </div> </div> </div> <h2 id=feature-scaling>Feature Scaling</h2> <p>Feature scaling overlaps with normalization but specifically addresses disparate scales across features. Beyond min-max and z-score, logarithmic scaling (<span class=arithmatex>\( x' = \log(x + 1) \)</span>) handles skewed distributions, common in financial data for neural forecasting models. Scaling ensures equal contribution of features during weight updates in stochastic gradient descent (SGD).</p> <h2 id=data-augmentation>Data Augmentation</h2> <p>Data augmentation artificially expands datasets to combat overfitting, particularly in CNNs for image classification. Basic operations include flipping, rotation (e.g., by 90° or random angles), and cropping, while advanced methods involve adding noise (Gaussian or salt-and-pepper) or color jittering. For text data in RNNs or transformers, techniques like synonym replacement, random insertion/deletion, or back-translation (translating to another language and back) generate variations while preserving semantics. In time-series for LSTMs, window slicing or synthetic minority over-sampling technique (SMOTE)<sup id=fnref:8><a class=footnote-ref href=#fn:8>1</a></sup> variants create augmented sequences. Generative models like GANs (Generative Adversarial Networks) represent cutting-edge augmentation, producing realistic synthetic samples. These methods improve generalization by exposing models to diverse inputs.</p> <h2 id=handling-imbalanced-data>Handling Imbalanced Data</h2> <p>Imbalanced datasets, where classes are unevenly represented, bias neural networks toward majority classes. Advanced resampling includes oversampling minorities (e.g., SMOTE, which interpolates new instances) or undersampling majorities. Class weighting assigns higher penalties to minority misclassifications in the loss function, e.g., weighted cross-entropy. Ensemble methods, like balanced random forests integrated with neural embeddings, or focal loss in object detection CNNs, further address this. For sequential data, temporal resampling ensures balanced windows.</p> <h2 id=feature-engineering-and-selection>Feature Engineering and Selection</h2> <p>Feature engineering crafts new features from existing ones, such as polynomial terms or interactions (e.g., <span class=arithmatex>\( x_1 \times x_2 \)</span>) to capture non-linearities before neural input. Selection techniques like mutual information or recursive feature elimination reduce irrelevant features, alleviating the curse of dimensionality in high-dimensional data for autoencoders or dense networks. Embedded methods, like L1 regularization in neural training, perform selection during optimization.</p> <h2 id=dimensionality-reduction>Dimensionality Reduction</h2> <p>Techniques like Principal Component Analysis (PCA) project data onto lower-dimensional spaces while preserving variance:</p> <div class=arithmatex>\[ X' = X \cdot W \]</div> <p>where <span class=arithmatex>\(W\)</span> are principal components. Autoencoders, a neural-based approach, learn compressed representations through encoder-decoder architectures. t-SNE or UMAP are used for visualization but less for preprocessing due to non-linearity. These are vital for CNNs on high-resolution images or transformers on long sequences to reduce computational load.</p> <p>PCA is widely used for dimensionality reduction<sup id=fnref:5><a class=footnote-ref href=#fn:5>2</a></sup>, while t-SNE<sup id=fnref:6><a class=footnote-ref href=#fn:6>3</a></sup> and UMAP<sup id=fnref:7><a class=footnote-ref href=#fn:7>4</a></sup> are popular for visualizing high-dimensional data in 2D or 3D spaces.</p> <p>Basically, PCA identifies orthogonal axes (principal components) capturing maximum variance, enabling efficient data representation. Autoencoders, trained to reconstruct inputs, learn compact latent spaces, useful for denoising or anomaly detection.</p> <div class="admonition info"> <p class=admonition-title>PCA Steps<sup id=fnref2:5><a class=footnote-ref href=#fn:5>2</a></sup></p> <p><strong>1. Standardize the data:</strong></p> <div class=arithmatex>\[ X' = \frac{X - μ}{σ} \]</div> <p><strong>2. Compute the covariance matrix:</strong></p> <div class=arithmatex>\[ C = \frac{1}{n} * (X'ᵀ * X') \]</div> <p><strong>3. Calculate eigenvalues and eigenvectors:</strong></p> <div class=arithmatex>\[ \text{eigvals}, \text{eigvecs} = \text{np.linalg.eig}(C) \]</div> <p><strong>4. Sort eigenvectors by eigenvalues in descending order.</strong></p> <p><strong>5. Select top <span class=arithmatex>\(k\)</span> eigenvectors to form a new feature space</strong></p> <div class=arithmatex>\[ Y = X' * W \]</div> <p>where <span class=arithmatex>\(W\)</span> is the matrix of selected eigenvectors.</p> </div> <p>A example of PCA applied to the Iris dataset:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=kn>from</span><span class=w> </span><span class=nn>io</span><span class=w> </span><span class=kn>import</span> <span class=n>StringIO</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>load_iris</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=c1># Loading Iris dataset</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=n>iris</span> <span class=o>=</span> <span class=n>load_iris</span><span class=p>()</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=c1># Transform in dataframe</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>    <span class=n>data</span><span class=o>=</span><span class=n>iris</span><span class=o>.</span><span class=n>data</span><span class=p>,</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>'sepal_l'</span><span class=p>,</span> <span class=s1>'sepal_w'</span><span class=p>,</span> <span class=s1>'petal_l'</span><span class=p>,</span> <span class=s1>'petal_w'</span><span class=p>]</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=p>)</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=n>df</span><span class=p>[</span><span class=s1>'class'</span><span class=p>]</span> <span class=o>=</span> <span class=n>iris</span><span class=o>.</span><span class=n>target_names</span><span class=p>[</span><span class=n>iris</span><span class=o>.</span><span class=n>target</span><span class=p>]</span>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=n>X</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=n>y</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=c1># Standardizing</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=n>X_std</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a><span class=c1># Covariance</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=n>cov_mat</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cov</span><span class=p>(</span><span class=n>X_std</span><span class=o>.</span><span class=n>T</span><span class=p>)</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=c1># Calculate autovalues and autovectors</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a><span class=n>eig_vals</span><span class=p>,</span> <span class=n>eig_vecs</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linalg</span><span class=o>.</span><span class=n>eig</span><span class=p>(</span><span class=n>cov_mat</span><span class=p>)</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Eigenvectors </span><span class=se>\n</span><span class=si>%s</span><span class=s1>'</span> <span class=o>%</span><span class=n>eig_vecs</span><span class=p>)</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=nb>print</span><span class=p>(</span><span class=s1>'</span><span class=se>\n</span><span class=s1>Eigenvalues </span><span class=se>\n</span><span class=si>%s</span><span class=s1>'</span> <span class=o>%</span><span class=n>eig_vals</span><span class=p>)</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class=c1># Make a list of (eigenvalue, eigenvector) tuples</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=n>eig_pairs</span> <span class=o>=</span> <span class=p>[(</span><span class=n>np</span><span class=o>.</span><span class=n>abs</span><span class=p>(</span><span class=n>eig_vals</span><span class=p>[</span><span class=n>i</span><span class=p>]),</span> <span class=n>eig_vecs</span><span class=p>[:,</span><span class=n>i</span><span class=p>])</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>eig_vals</span><span class=p>))]</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a><span class=c1># Sort the (eigenvalue, eigenvector) tuples from high to low</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a><span class=n>eig_pairs</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a><span class=c1># Visually confirm that the list is correctly sorted by decreasing eigenvalues</span>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Eigenvalues in descending order:'</span><span class=p>)</span>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>eig_pairs</span><span class=p>:</span> <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a><span class=c1># Sum the cummulative of each eigen value</span>
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44 href=#__codelineno-3-44></a><span class=n>tot</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>eig_vals</span><span class=p>)</span>
</span><span id=__span-3-45><a id=__codelineno-3-45 name=__codelineno-3-45 href=#__codelineno-3-45></a><span class=n>var_exp</span> <span class=o>=</span> <span class=p>[(</span><span class=n>i</span> <span class=o>/</span> <span class=n>tot</span><span class=p>)</span><span class=o>*</span><span class=mi>100</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>eig_vals</span><span class=p>,</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)]</span>
</span><span id=__span-3-46><a id=__codelineno-3-46 name=__codelineno-3-46 href=#__codelineno-3-46></a><span class=n>cum_var_exp</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>cumsum</span><span class=p>(</span><span class=n>var_exp</span><span class=p>)</span>
</span><span id=__span-3-47><a id=__codelineno-3-47 name=__codelineno-3-47 href=#__codelineno-3-47></a>
</span><span id=__span-3-48><a id=__codelineno-3-48 name=__codelineno-3-48 href=#__codelineno-3-48></a><span class=n>n_eigen</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]</span>
</span><span id=__span-3-49><a id=__codelineno-3-49 name=__codelineno-3-49 href=#__codelineno-3-49></a>
</span><span id=__span-3-50><a id=__codelineno-3-50 name=__codelineno-3-50 href=#__codelineno-3-50></a><span class=c1># Plot the cumulative for each eign value</span>
</span><span id=__span-3-51><a id=__codelineno-3-51 name=__codelineno-3-51 href=#__codelineno-3-51></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span><span id=__span-3-52><a id=__codelineno-3-52 name=__codelineno-3-52 href=#__codelineno-3-52></a><span class=n>plt</span><span class=o>.</span><span class=n>bar</span><span class=p>(</span><span class=n>n_eigen</span><span class=p>,</span> <span class=n>var_exp</span><span class=p>,</span> <span class=n>alpha</span><span class=o>=</span><span class=mf>0.5</span><span class=p>,</span> <span class=n>align</span><span class=o>=</span><span class=s1>'center'</span><span class=p>,</span>
</span><span id=__span-3-53><a id=__codelineno-3-53 name=__codelineno-3-53 href=#__codelineno-3-53></a>    <span class=n>label</span><span class=o>=</span><span class=s1>'individual explained variance'</span><span class=p>)</span>
</span><span id=__span-3-54><a id=__codelineno-3-54 name=__codelineno-3-54 href=#__codelineno-3-54></a><span class=n>plt</span><span class=o>.</span><span class=n>step</span><span class=p>(</span><span class=n>n_eigen</span><span class=p>,</span> <span class=n>cum_var_exp</span><span class=p>,</span> <span class=n>where</span><span class=o>=</span><span class=s1>'mid'</span><span class=p>,</span>
</span><span id=__span-3-55><a id=__codelineno-3-55 name=__codelineno-3-55 href=#__codelineno-3-55></a>    <span class=n>label</span><span class=o>=</span><span class=s1>'cumulative explained variance'</span><span class=p>)</span>
</span><span id=__span-3-56><a id=__codelineno-3-56 name=__codelineno-3-56 href=#__codelineno-3-56></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Explained variance ratio'</span><span class=p>)</span>
</span><span id=__span-3-57><a id=__codelineno-3-57 name=__codelineno-3-57 href=#__codelineno-3-57></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Principal components'</span><span class=p>)</span>
</span><span id=__span-3-58><a id=__codelineno-3-58 name=__codelineno-3-58 href=#__codelineno-3-58></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>'best'</span><span class=p>)</span>
</span><span id=__span-3-59><a id=__codelineno-3-59 name=__codelineno-3-59 href=#__codelineno-3-59></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-3-60><a id=__codelineno-3-60 name=__codelineno-3-60 href=#__codelineno-3-60></a>
</span><span id=__span-3-61><a id=__codelineno-3-61 name=__codelineno-3-61 href=#__codelineno-3-61></a><span class=c1># Take the only the two firsts eigen values</span>
</span><span id=__span-3-62><a id=__codelineno-3-62 name=__codelineno-3-62 href=#__codelineno-3-62></a><span class=n>matrix_w</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>eig_pairs</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=mi>1</span><span class=p>),</span>
</span><span id=__span-3-63><a id=__codelineno-3-63 name=__codelineno-3-63 href=#__codelineno-3-63></a>                      <span class=n>eig_pairs</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span><span class=mi>1</span><span class=p>)))</span>
</span><span id=__span-3-64><a id=__codelineno-3-64 name=__codelineno-3-64 href=#__codelineno-3-64></a>
</span><span id=__span-3-65><a id=__codelineno-3-65 name=__codelineno-3-65 href=#__codelineno-3-65></a><span class=nb>print</span><span class=p>(</span><span class=s1>'*'</span> <span class=o>*</span> <span class=mi>10</span><span class=p>)</span>
</span><span id=__span-3-66><a id=__codelineno-3-66 name=__codelineno-3-66 href=#__codelineno-3-66></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Reduced to 2-D'</span><span class=p>)</span>
</span><span id=__span-3-67><a id=__codelineno-3-67 name=__codelineno-3-67 href=#__codelineno-3-67></a><span class=nb>print</span><span class=p>(</span><span class=s1>'Matrix W:</span><span class=se>\n</span><span class=s1>'</span><span class=p>,</span> <span class=n>matrix_w</span><span class=p>)</span>
</span><span id=__span-3-68><a id=__codelineno-3-68 name=__codelineno-3-68 href=#__codelineno-3-68></a>
</span><span id=__span-3-69><a id=__codelineno-3-69 name=__codelineno-3-69 href=#__codelineno-3-69></a><span class=c1># Calculate the new Y for all samples</span>
</span><span id=__span-3-70><a id=__codelineno-3-70 name=__codelineno-3-70 href=#__codelineno-3-70></a><span class=n>Y</span> <span class=o>=</span> <span class=n>X_std</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>matrix_w</span><span class=p>)</span>
</span><span id=__span-3-71><a id=__codelineno-3-71 name=__codelineno-3-71 href=#__codelineno-3-71></a>
</span><span id=__span-3-72><a id=__codelineno-3-72 name=__codelineno-3-72 href=#__codelineno-3-72></a><span class=c1># Plot the data for the 2 firsts principal components</span>
</span><span id=__span-3-73><a id=__codelineno-3-73 name=__codelineno-3-73 href=#__codelineno-3-73></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span><span id=__span-3-74><a id=__codelineno-3-74 name=__codelineno-3-74 href=#__codelineno-3-74></a><span class=k>for</span> <span class=n>lab</span><span class=p>,</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>((</span><span class=s1>'setosa'</span><span class=p>,</span> <span class=s1>'versicolor'</span><span class=p>,</span> <span class=s1>'virginica'</span><span class=p>),</span> <span class=p>(</span><span class=s1>'blue'</span><span class=p>,</span> <span class=s1>'red'</span><span class=p>,</span> <span class=s1>'green'</span><span class=p>)):</span>
</span><span id=__span-3-75><a id=__codelineno-3-75 name=__codelineno-3-75 href=#__codelineno-3-75></a>    <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>Y</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>lab</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span><span id=__span-3-76><a id=__codelineno-3-76 name=__codelineno-3-76 href=#__codelineno-3-76></a>                <span class=n>Y</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>lab</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span>
</span><span id=__span-3-77><a id=__codelineno-3-77 name=__codelineno-3-77 href=#__codelineno-3-77></a>                <span class=n>label</span><span class=o>=</span><span class=n>lab</span><span class=p>,</span>
</span><span id=__span-3-78><a id=__codelineno-3-78 name=__codelineno-3-78 href=#__codelineno-3-78></a>                <span class=n>c</span><span class=o>=</span><span class=n>col</span><span class=p>)</span>
</span><span id=__span-3-79><a id=__codelineno-3-79 name=__codelineno-3-79 href=#__codelineno-3-79></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Principal Component 1'</span><span class=p>)</span>
</span><span id=__span-3-80><a id=__codelineno-3-80 name=__codelineno-3-80 href=#__codelineno-3-80></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Principal Component 2'</span><span class=p>)</span>
</span><span id=__span-3-81><a id=__codelineno-3-81 name=__codelineno-3-81 href=#__codelineno-3-81></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>'lower center'</span><span class=p>)</span>
</span><span id=__span-3-82><a id=__codelineno-3-82 name=__codelineno-3-82 href=#__codelineno-3-82></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-3-83><a id=__codelineno-3-83 name=__codelineno-3-83 href=#__codelineno-3-83></a>
</span><span id=__span-3-84><a id=__codelineno-3-84 name=__codelineno-3-84 href=#__codelineno-3-84></a><span class=c1># Para imprimir na página HTML</span>
</span><span id=__span-3-85><a id=__codelineno-3-85 name=__codelineno-3-85 href=#__codelineno-3-85></a><span class=n>buffer</span> <span class=o>=</span> <span class=n>StringIO</span><span class=p>()</span>
</span><span id=__span-3-86><a id=__codelineno-3-86 name=__codelineno-3-86 href=#__codelineno-3-86></a><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>"svg"</span><span class=p>,</span> <span class=n>transparent</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-87><a id=__codelineno-3-87 name=__codelineno-3-87 href=#__codelineno-3-87></a><span class=nb>print</span><span class=p>(</span><span class=n>buffer</span><span class=o>.</span><span class=n>getvalue</span><span class=p>())</span>
</span></code></pre></div> <p>Now, the same example using scikit-learn is shown below:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=kn>from</span><span class=w> </span><span class=nn>io</span><span class=w> </span><span class=kn>import</span> <span class=n>StringIO</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.datasets</span><span class=w> </span><span class=kn>import</span> <span class=n>load_iris</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.decomposition</span><span class=w> </span><span class=kn>import</span> <span class=n>PCA</span> <span class=k>as</span> <span class=n>pca</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=c1># Loading Iris dataset</span>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=n>iris</span> <span class=o>=</span> <span class=n>load_iris</span><span class=p>()</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=c1># Transform in dataframe</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>    <span class=n>data</span><span class=o>=</span><span class=n>iris</span><span class=o>.</span><span class=n>data</span><span class=p>,</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>    <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>'sepal_l'</span><span class=p>,</span> <span class=s1>'sepal_w'</span><span class=p>,</span> <span class=s1>'petal_l'</span><span class=p>,</span> <span class=s1>'petal_w'</span><span class=p>]</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=p>)</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=n>df</span><span class=p>[</span><span class=s1>'class'</span><span class=p>]</span> <span class=o>=</span> <span class=n>iris</span><span class=o>.</span><span class=n>target_names</span><span class=p>[</span><span class=n>iris</span><span class=o>.</span><span class=n>target</span><span class=p>]</span>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=n>X</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=n>y</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>iloc</span><span class=p>[:,</span><span class=mi>4</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=c1># Standardizing</span>
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=n>X_std</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=n>sklearn_pca</span> <span class=o>=</span> <span class=n>pca</span><span class=p>(</span><span class=n>n_components</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=n>Y</span> <span class=o>=</span> <span class=n>sklearn_pca</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X_std</span><span class=p>)</span>
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=c1># Plot the data for the 2 firsts principal components</span>
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>6</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span><span id=__span-4-29><a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=k>for</span> <span class=n>lab</span><span class=p>,</span> <span class=n>col</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>((</span><span class=s1>'setosa'</span><span class=p>,</span> <span class=s1>'versicolor'</span><span class=p>,</span> <span class=s1>'virginica'</span><span class=p>),</span> <span class=p>(</span><span class=s1>'blue'</span><span class=p>,</span> <span class=s1>'red'</span><span class=p>,</span> <span class=s1>'green'</span><span class=p>)):</span>
</span><span id=__span-4-30><a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>    <span class=n>plt</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>Y</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>lab</span><span class=p>,</span> <span class=mi>0</span><span class=p>],</span>
</span><span id=__span-4-31><a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a>                <span class=n>Y</span><span class=p>[</span><span class=n>y</span><span class=o>==</span><span class=n>lab</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span>
</span><span id=__span-4-32><a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a>                <span class=n>label</span><span class=o>=</span><span class=n>lab</span><span class=p>,</span>
</span><span id=__span-4-33><a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a>                <span class=n>c</span><span class=o>=</span><span class=n>col</span><span class=p>)</span>
</span><span id=__span-4-34><a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>'Principal Component 1'</span><span class=p>)</span>
</span><span id=__span-4-35><a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>'Principal Component 2'</span><span class=p>)</span>
</span><span id=__span-4-36><a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>(</span><span class=n>loc</span><span class=o>=</span><span class=s1>'lower center'</span><span class=p>)</span>
</span><span id=__span-4-37><a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
</span><span id=__span-4-38><a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a>
</span><span id=__span-4-39><a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a><span class=c1># Para imprimir na página HTML</span>
</span><span id=__span-4-40><a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a><span class=n>buffer</span> <span class=o>=</span> <span class=n>StringIO</span><span class=p>()</span>
</span><span id=__span-4-41><a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a><span class=n>plt</span><span class=o>.</span><span class=n>savefig</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>"svg"</span><span class=p>,</span> <span class=n>transparent</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-4-42><a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a><span class=nb>print</span><span class=p>(</span><span class=n>buffer</span><span class=o>.</span><span class=n>getvalue</span><span class=p>())</span>
</span></code></pre></div> <p>Eigenfaces, a PCA variant, is used in face recognition tasks to reduce image dimensions while retaining essential features<sup id=fnref:4><a class=footnote-ref href=#fn:4>5</a></sup>. In NLP, techniques like Latent Semantic Analysis (LSA) apply SVD (Singular Value Decomposition) to reduce term-document matrices, enhancing transformer efficiency.</p> <h2 id=domain-specific-advanced-techniques>Domain-Specific Advanced Techniques</h2> <p>For time-series in RNNs, techniques include Fast Fourier Transform (FFT) for frequency domain conversion or segmentation into fixed windows. In text preprocessing for sentiment analysis, advanced steps encompass negation handling (e.g., marking "not good" as "not_pos"), intensification (e.g., "very good" as "strong_pos"), and POS tagging to retain sentiment-bearing words. For images in CNNs, advanced signal processing like wavelet transforms or conversion to spectrograms enhances fault diagnosis applications.</p> <hr> <h2 id=appendix>Appendix</h2> <h3 id=normalization-vs-standardization-in-neural-network-preprocessing>Normalization vs. Standardization in Neural Network Preprocessing</h3> <p>In data preprocessing for neural networks, both normalization and standardization are feature scaling techniques used to handle features with different scales, improve model convergence, stabilize gradients during training, and prevent features with larger ranges from dominating the learning process. These methods are particularly important for optimization algorithms like gradient descent, which neural networks rely on.</p> <ul> <li> <p><strong>Normalization (Min-Max Scaling)</strong>: This scales the data to a fixed range, typically [0, 1] or [-1, 1], using the formula: <span class=arithmatex>\( \displaystyle x' = \frac{x - \min(x)}{\max(x) - \min(x)} \)</span>. It preserves the original data distribution but is sensitive to outliers, as extreme values can compress the rest of the data into a narrow interval.</p> </li> <li> <p><strong>Standardization (Z-Score Scaling)</strong>: This transforms the data to have a mean of 0 and a standard deviation of 1, using the formula: <span class=arithmatex>\( \displaystyle z = \frac{x - \mu}{\sigma} \)</span>, where <span class=arithmatex>\(\mu\)</span> is the mean and <span class=arithmatex>\(\sigma\)</span> is the standard deviation. It centers the data and is more robust to outliers, but it does not bound the values to a specific range.</p> </li> </ul> <p>There is no universal "better" method; the choice depends on the data characteristics, the neural network architecture, and empirical testing. If the dataset is small, it's often worth experimenting with both to see which yields better performance. Below, I'll outline guidelines for when each is appropriate, with specific situations or cases, especially in the context of neural networks.</p> <p><strong>When to Use Normalization</strong></p> <p>Normalization is preferred when the data needs to be bounded within a specific range, the distribution is unknown or non-Gaussian, and there are no significant outliers. It helps avoid numeric overflow in neural networks, speeds up learning, and works well with activation functions that expect inputs in a constrained range. Key situations include:</p> <ul> <li> <p><strong>Bounded Data or Activation Functions Sensitive to Range</strong>: Use normalization for neural networks with sigmoid or tanh activations, as these functions perform better with inputs scaled to [0, 1] or [-1, 1] to prevent saturation (where gradients become near zero). For example, in image classification tasks with convolutional neural networks (CNNs), pixel values (typically 0-255) are often normalized to [0, 1] to ensure consistent scaling and faster convergence.</p> </li> <li> <p><strong>Features with Known Min/Max Bounds and No Outliers</strong>: When the data has clear minimum and maximum values (e.g., sensor readings bounded between fixed limits), normalization prevents larger-scale features from dominating. A case is processing demographic data like age (e.g., 0-100) in a feedforward neural network for prediction tasks, where scaling to [0, 1] maintains proportionality without assuming a normal distribution.</p> </li> <li> <p><strong>General Speed Improvements in Training</strong>: In scenarios where neural networks handle features like age and weight, normalization to [0, 1] can accelerate training and testing by keeping inputs small and consistent, reducing the risk of overflow.</p> </li> </ul> <p><strong>When to Use Standardization</strong></p> <p>Standardization is suitable when the data approximates a Gaussian (normal) distribution, outliers are present, or the model benefits from centered data with unit variance. It helps prevent gradient saturation in neural networks, improves numerical stability, and is often the default choice for many algorithms. Specific cases include:</p> <ul> <li> <p><strong>Data with Outliers or Unknown Distribution</strong>: Standardization is more robust to outliers, as it doesn't compress values into a fixed range like normalization does. For instance, in financial datasets for stock price prediction using recurrent neural networks (RNNs), where extreme values (e.g., market crashes) are common, standardization preserves the relative importance of outliers without skewing the scale.</p> </li> <li> <p><strong>Gaussian-Like Data or Convergence-Focused Models</strong>: When features follow a bell-curve distribution (verifiable by plotting), standardization aligns with assumptions in techniques like batch normalization in deep neural networks. An example is sensor data analysis in IoT applications with neural networks, where standardization ensures faster gradient descent convergence by centering the data.</p> </li> <li> <p><strong>Standard Practice for Neural Networks</strong>: As recommended in foundational work like Yann LeCun's efficient backpropagation paper, scaling to mean 0 and variance 1 is a go-to method to avoid saturating hidden units and handle numerical issues in training. This is common in large-scale datasets for tasks like natural language processing with transformers.</p> </li> </ul> <p>In practice, for neural networks, standardization is often preferred as a starting point due to its robustness, but normalization shines in bounded, outlier-free scenarios. Always apply scaling after splitting data into train/test sets to avoid data leakage, and use libraries like scikit-learn's <a href=https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html target=_blank><code>MinMaxScaler</code></a> or <a href=https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html target=_blank><code>StandardScaler</code></a> for implementation.</p> <div class=footnote> <hr> <ol> <li id=fn:8> <p><a href=https://arxiv.org/abs/1106.1813 target=_blank>SMOTE - Synthetic Minority Over-sampling Technique</a>&nbsp;<a class=footnote-backref href=#fnref:8 title="Jump back to footnote 1 in the text">↩</a></p> </li> <li id=fn:5> <p><a href=https://en.wikipedia.org/wiki/Principal_component_analysis target=_blank>PCA - Principal Component Analysis</a>&nbsp;<a class=footnote-backref href=#fnref:5 title="Jump back to footnote 2 in the text">↩</a><a class=footnote-backref href=#fnref2:5 title="Jump back to footnote 2 in the text">↩</a></p> </li> <li id=fn:6> <p><a href=https://bagheri365.github.io/blog/Principal-Component-Analysis-from-Scratch/ target=_blank>Principal Component Analysis (PCA) from Scratch</a>&nbsp;<a class=footnote-backref href=#fnref:6 title="Jump back to footnote 3 in the text">↩</a></p> </li> <li id=fn:7> <p><a href=https://distill.pub/2016/misread-tsne/ target=_blank>t-SNE - t-distributed Stochastic Neighbor Embedding</a>&nbsp;<a class=footnote-backref href=#fnref:7 title="Jump back to footnote 4 in the text">↩</a></p> </li> <li id=fn:4> <p><a href=https://docs.opencv.org/4.x/da/d60/tutorial_face_main.html target=_blank>Face Recognition with OpenCV</a>&nbsp;<a class=footnote-backref href=#fnref:4 title="Jump back to footnote 5 in the text">↩</a></p> </li> <li id=fn:1> <p><a href=https://scikit-learn.org/stable/modules/preprocessing.html target=_blank>Scikit-learn - Preprocessing data</a>&nbsp;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 6 in the text">↩</a></p> </li> <li id=fn:2> <p><a href=https://www.tensorflow.org/tutorials/images/data_augmentation target=_blank>TensorFlow - Data Augmentation</a>&nbsp;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 7 in the text">↩</a></p> </li> <li id=fn:3> <p><a href=https://arxiv.org/abs/1708.02002 target=_blank>AutoML - Automated Machine Learning</a>&nbsp;<a class=footnote-backref href=#fnref:3 title="Jump back to footnote 8 in the text">↩</a></p> </li> <li id=fn:9> <p><a href=https://arxiv.org/abs/1708.02002 target=_blank>Focal Loss for Dense Object Detection</a>&nbsp;<a class=footnote-backref href=#fnref:9 title="Jump back to footnote 9 in the text">↩</a></p> </li> <li id=fn:10> <p><a href=https://nlp.stanford.edu/projects/glove/ target=_blank>Word Embeddings - Word2Vec, GloVe, FastText</a>&nbsp;<a class=footnote-backref href=#fnref:10 title="Jump back to footnote 10 in the text">↩</a></p> </li> </ol> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 21, 2025 19:13:22 UTC">October 21, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="October 21, 2025 19:13:22 UTC">October 21, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"></path></svg> </span> <nav> <a href=mailto:hsandmann@ieee.org>Humberto Sandmann</a> </nav> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path></svg> </span> <span>GitHub</span> <nav> <a href=https://github.com/hsandmann class=md-author title=@hsandmann> <img src="https://avatars.githubusercontent.com/u/20843348?v=4&size=72" alt=hsandmann> </a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src=../../assets/javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../assets/javascripts/badge.js async></script> <script src=../../termynal.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>